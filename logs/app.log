2024-11-24 06:26:42,867 - src.finalization - INFO - src.finalization module loaded
2024-11-24 06:26:42,872 - src.pipeline - INFO - Loading dataset from data/StudentsPerformance.csv...
2024-11-24 06:26:42,883 - src.pipeline - INFO - Dataset loaded successfully. Shape: (1000, 8)
2024-11-24 06:26:42,884 - src.pipeline - INFO - Original math_score range: 0 to 100
2024-11-24 06:26:42,884 - src.pipeline - INFO - Starting missing value imputation...
2024-11-24 06:26:42,884 - src.utils - INFO - Starting automatic imputation...
2024-11-24 06:26:42,885 - src.utils - INFO - Numerical columns: ['reading_score', 'writing_score']
2024-11-24 06:26:42,885 - src.utils - INFO - Categorical columns: ['gender', 'race_ethnicity', 'parental_level_of_education', 'lunch', 'test_preparation_course']
2024-11-24 06:26:42,890 - src.utils - INFO - Applying ordinal encoding to categorical columns...
2024-11-24 06:26:42,910 - src.utils - INFO - Processing column 'gender' with 0.00% missing values.
2024-11-24 06:26:42,911 - src.utils - INFO - Column 'gender' has no missing values. Skipping imputation.
2024-11-24 06:26:42,911 - src.utils - INFO - Processing column 'race_ethnicity' with 0.00% missing values.
2024-11-24 06:26:42,911 - src.utils - INFO - Column 'race_ethnicity' has no missing values. Skipping imputation.
2024-11-24 06:26:42,911 - src.utils - INFO - Processing column 'parental_level_of_education' with 0.00% missing values.
2024-11-24 06:26:42,912 - src.utils - INFO - Column 'parental_level_of_education' has no missing values. Skipping imputation.
2024-11-24 06:26:42,912 - src.utils - INFO - Processing column 'lunch' with 0.00% missing values.
2024-11-24 06:26:42,912 - src.utils - INFO - Column 'lunch' has no missing values. Skipping imputation.
2024-11-24 06:26:42,912 - src.utils - INFO - Processing column 'test_preparation_course' with 0.00% missing values.
2024-11-24 06:26:42,912 - src.utils - INFO - Column 'test_preparation_course' has no missing values. Skipping imputation.
2024-11-24 06:26:42,913 - src.utils - INFO - Processing column 'reading_score' with 0.00% missing values.
2024-11-24 06:26:42,913 - src.utils - INFO - Column 'reading_score' has no missing values. Skipping imputation.
2024-11-24 06:26:42,913 - src.utils - INFO - Processing column 'writing_score' with 0.00% missing values.
2024-11-24 06:26:42,913 - src.utils - INFO - Column 'writing_score' has no missing values. Skipping imputation.
2024-11-24 06:26:42,913 - src.utils - INFO - Imputation complete.
2024-11-24 06:26:42,913 - src.pipeline - INFO - Missing value imputation complete.
2024-11-24 06:26:42,913 - src.pipeline - INFO - Handling categorical features...
2024-11-24 06:26:42,918 - src.data_preprocessing - INFO - Starting to handle categorical features...
2024-11-24 06:26:42,919 - src.data_preprocessing - INFO - Categorical columns identified: []
2024-11-24 06:26:42,919 - src.data_preprocessing - INFO - Completed handling of categorical features.
2024-11-24 06:26:42,919 - src.pipeline - INFO - Categorical feature encoding complete.
2024-11-24 06:26:42,920 - src.pipeline - INFO - Performing feature engineering...
2024-11-24 06:26:42,920 - src.feature_engineering - INFO - Starting feature engineering...
2024-11-24 06:26:42,920 - src.feature_engineering - INFO - Identified numerical columns: ['gender', 'race_ethnicity', 'parental_level_of_education', 'lunch', 'test_preparation_course', 'math_score', 'reading_score', 'writing_score']
2024-11-24 06:26:42,920 - src.feature_engineering - INFO - Creating interaction terms...
2024-11-24 06:26:42,953 - src.feature_engineering - INFO - Creating aggregate features (ratios)...
2024-11-24 06:26:42,984 - src.feature_engineering - INFO - Normalizing numerical features...
2024-11-24 06:26:42,997 - src.feature_engineering - INFO - Applying log transformations for skewed columns...
2024-11-24 06:26:43,004 - src.feature_engineering - INFO - Removing low variance features...
2024-11-24 06:26:43,024 - src.feature_engineering - INFO - Removing highly correlated features...
2024-11-24 06:26:43,063 - src.feature_engineering - INFO - Dropping 21 highly correlated columns: ['writing_score', 'gender_x_math_score', 'gender_x_reading_score', 'gender_x_writing_score', 'race_ethnicity_x_math_score', 'race_ethnicity_x_reading_score', 'race_ethnicity_x_writing_score', 'parental_level_of_education_x_math_score', 'parental_level_of_education_x_reading_score', 'parental_level_of_education_x_writing_score', 'lunch_x_math_score', 'lunch_x_reading_score', 'lunch_x_writing_score', 'test_preparation_course_x_math_score', 'test_preparation_course_x_reading_score', 'test_preparation_course_x_writing_score', 'math_score_x_reading_score', 'math_score_x_writing_score', 'reading_score_x_writing_score', 'parental_level_of_education_to_math_score', 'test_preparation_course_to_math_score']
2024-11-24 06:26:43,065 - src.feature_engineering - INFO - Feature engineering complete. Final feature count: 30
2024-11-24 06:26:43,065 - src.pipeline - INFO - Feature engineering complete.
2024-11-24 06:26:43,065 - src.pipeline - INFO - Splitting data into training and testing sets...
2024-11-24 06:26:43,065 - src.model_selection - INFO - Starting train-test split and model selection...
2024-11-24 06:26:43,072 - src.model_selection - INFO - Cleaned column names: ['gender', 'race_ethnicity', 'parental_level_of_education', 'lunch', 'test_preparation_course', 'math_score', 'reading_score', 'gender_x_race_ethnicity', 'gender_x_parental_level_of_education', 'gender_x_lunch', 'gender_x_test_preparation_course', 'race_ethnicity_x_parental_level_of_education', 'race_ethnicity_x_lunch', 'race_ethnicity_x_test_preparation_course', 'parental_level_of_education_x_lunch', 'parental_level_of_education_x_test_preparation_course', 'lunch_x_test_preparation_course', 'gender_to_race_ethnicity', 'gender_to_parental_level_of_education', 'gender_to_lunch', 'gender_to_test_preparation_course', 'race_ethnicity_to_parental_level_of_education', 'race_ethnicity_to_lunch', 'race_ethnicity_to_test_preparation_course', 'race_ethnicity_to_math_score', 'parental_level_of_education_to_lunch', 'parental_level_of_education_to_test_preparation_course', 'lunch_to_test_preparation_course', 'math_score_to_reading_score', 'math_score_to_writing_score']
2024-11-24 06:26:43,073 - src.model_selection - INFO - Splitting dataset into training and testing sets with target column: math_score
2024-11-24 06:26:43,082 - src.model_selection - INFO - Train-test split completed. Training size: 800, Testing size: 200
2024-11-24 06:26:43,082 - src.model_selection - INFO - Training Linear Regression...
2024-11-24 06:26:43,136 - src.model_selection - INFO - Model: Linear Regression, Score: 66059.75711484905
2024-11-24 06:26:43,136 - src.model_selection - INFO - Training KNN...
2024-11-24 06:26:43,590 - src.model_selection - INFO - Model: KNN, Score: 0.8777886460567254
2024-11-24 06:26:43,590 - src.model_selection - INFO - Training Decision Tree...
2024-11-24 06:26:43,629 - src.model_selection - INFO - Model: Decision Tree, Score: 0.1656808722466211
2024-11-24 06:26:43,629 - src.model_selection - INFO - Training Random Forest...
2024-11-24 06:26:45,917 - src.model_selection - INFO - Model: Random Forest, Score: 0.14718917131885567
2024-11-24 06:26:45,917 - src.model_selection - INFO - Training Gradient Boosting...
2024-11-24 06:26:46,676 - src.model_selection - INFO - Model: Gradient Boosting, Score: 0.10454630924426539
2024-11-24 06:26:46,676 - src.model_selection - INFO - Training SVR...
2024-11-24 06:26:46,872 - src.model_selection - INFO - Model: SVR, Score: 0.9942712810734119
2024-11-24 06:26:46,873 - src.model_selection - INFO - Training XGBoost...
2024-11-24 06:26:49,454 - src.model_selection - INFO - Model: XGBoost, Score: 0.10345021737129327
2024-11-24 06:26:49,454 - src.model_selection - INFO - Training AdaBoost...
2024-11-24 06:26:50,015 - src.model_selection - INFO - Model: AdaBoost, Score: 0.2682892091633619
2024-11-24 06:26:50,015 - src.model_selection - INFO - Training Extra Trees...
2024-11-24 06:26:51,847 - src.model_selection - INFO - Model: Extra Trees, Score: 0.13345813277206414
2024-11-24 06:26:51,847 - src.model_selection - INFO - Training LightGBM...
2024-11-24 06:27:10,522 - src.model_selection - INFO - Model: LightGBM, Score: 0.1610002791870705
2024-11-24 06:27:10,524 - src.model_selection - INFO - 
Model Selection Complete. Results:
2024-11-24 06:27:10,540 - src.model_selection - INFO - 
               Model         Score
6            XGBoost      0.103450
4  Gradient Boosting      0.104546
8        Extra Trees      0.133458
3      Random Forest      0.147189
9           LightGBM      0.161000
2      Decision Tree      0.165681
7           AdaBoost      0.268289
1                KNN      0.877789
5                SVR      0.994271
0  Linear Regression  66059.757115
2024-11-24 06:27:10,540 - src.model_selection - INFO - Best Model: XGBoost
2024-11-24 06:27:10,549 - src.pipeline - INFO - Scaling the target variable...
2024-11-24 06:27:10,556 - src.pipeline - INFO - Performing hyperparameter tuning for the best model: XGBoost...
2024-11-24 06:27:10,556 - src.hyperparameter_tuning - INFO - Starting hyperparameter tuning for XGBoost...
2024-11-24 06:27:10,556 - src.hyperparameter_tuning - INFO - Performing hyperparameter tuning for XGBoost...
2024-11-24 06:27:40,593 - src.hyperparameter_tuning - INFO - Best hyperparameters for XGBoost: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 500, 'subsample': 0.8}
2024-11-24 06:27:40,631 - src.hyperparameter_tuning - INFO - RMSE of the tuned XGBoost model: 0.0883568983345576
2024-11-24 06:27:40,631 - src.pipeline - INFO - Finalizing and evaluating the model...
2024-11-24 06:27:40,631 - src.finalization - INFO - Initializing the model with best hyperparameters...
2024-11-24 06:27:40,631 - src.finalization - INFO - Training the model with best hyperparameters...
2024-11-24 06:27:54,767 - src.finalization - INFO - Predicting on the test set...
2024-11-24 06:27:54,795 - src.finalization - INFO - Evaluating model performance...
2024-11-24 06:27:54,803 - src.finalization - INFO - RMSE of the final model: 0.08846015646215694
2024-11-24 06:27:54,803 - src.finalization - INFO - R-squared of the final model: 0.9927501310728963
2024-11-24 06:27:54,804 - src.finalization - INFO - Extracting feature importances...
2024-11-24 06:27:54,805 - src.finalization - INFO - Plotting feature importances...
2024-11-24 06:27:55,668 - src.finalization - INFO - Model saved as best_model.joblib
2024-11-24 06:27:55,670 - src.pipeline - INFO - Final metrics: {'RMSE': np.float64(0.08846015646215694), 'R-squared': 0.9927501310728963}
2024-11-24 06:27:55,670 - src.pipeline - INFO - Saving the model and associated artifacts...
2024-11-24 06:27:55,702 - src.pipeline - INFO - Model and artifacts saved successfully.
